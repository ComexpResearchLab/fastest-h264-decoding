duration small-bunny -- 2.01m = 121s
duration b264t_half -- 28m:26.47s = 1706.5

# что происходит?
1. чек argc
2. malloc для formatContext
3. открытие стрима для формата (ffprobe?)
4. поиск инфы стрима
5. foreach stream
    - codecparams = context.streams[i].codecpar(ameters)
    - avcodec_find_decoder
    - if codectype = video_type  and video stream index == -1 {set codec, codecparams, video stream index=!-1} 
6. malloc для codecContext
7. передача параметров в контекст
8. открыть кодек
9. malloc для frame
10. malloc для пакета
11. while (can_read_frame)
    - if packet.stream_index = video_stream_index
        - avcodec_send_packet
        - while avcodec_receive_frame
            - null
    - av_packet_unref


имеет смысл оптимизировать:
1. avcodec_send_packet
2. av_read_frame
3. av_packet_unref
4. avcodec_receive_frame

c av_packet_unref (результаты с другого такого же бенча) для b264t_half
```  
% time     seconds  usecs/call     calls      function
------ ----------- ----------- --------- --------------------
 60.88   39.686826         775     51143 avcodec_send_packet
 15.04    9.805516          74    131135 av_read_frame
 12.78    8.328330          63    131134 av_packet_unref
 10.36    6.753832          66    102286 avcodec_receive_frame
  0.89    0.579211          30     18783 SYS_read
  0.01    0.007988        7988         1 avformat_find_stream_info
  0.01    0.005006        5006         1 avformat_open_input
...
------ ----------- ----------- --------- --------------------
100.00   65.188671                434851 total
```
без c av_packet_unref -- ~-12%
```
% time     seconds  usecs/call     calls      function
------ ----------- ----------- --------- --------------------
 68.66   39.649072         775     51143 avcodec_send_packet
 18.11   10.460121          79    131135 av_read_frame
 11.85    6.842599          66    102286 avcodec_receive_frame
  1.09    0.631828          33     18783 SYS_read
  0.23    0.133065          28      4685 SYS_brk
  0.01    0.007196        7196         1 avformat_find_stream_info
  0.01    0.005311        5311         1 avformat_open_input
...
------ ----------- ----------- --------- --------------------
100.00   57.747016                308376 total
```


 --disable-safe-bitstream-reader
                           disable buffer boundary checking in bitreaders
                           (faster, but may crash)
флаг в configure libav, очень интересно


# компиляция
sudo apt-get update -qq && sudo apt-get -y install \
  autoconf \
  automake \
  build-essential \
  cmake \
  git-core \
  libass-dev \
  libfreetype6-dev \
  libgnutls28-dev \
  libmp3lame-dev \
  libsdl2-dev \
  libtool \
  libva-dev \
  libvdpau-dev \
  libvorbis-dev \
  libxcb1-dev \
  libxcb-shm0-dev \
  libxcb-xfixes0-dev \
  meson \
  ninja-build \
  pkg-config \
  texinfo \
  wget \
  yasm \
  zlib1g-dev

sudo apt-get install libx264-dev

./configure --enable-shared --enable-libx264 --enable-gpl --enable-pic